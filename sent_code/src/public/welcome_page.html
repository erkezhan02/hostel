<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Booking</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
        <a class="navbar-brand" href="welcome_page.html">HotelBooking</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item">
                    <a class="nav-link" href="welcome_page.html">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="login.html">Login</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="register.html">Register</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- Home Page -->
<div class="container mt-5" id="homePage">
    <h2 class="mb-4">Featured Hotels</h2>
    <div class="row">
        <!-- Hotel Card 1 -->
        <div class="col-md-4 mb-4">
            <div class="card">
                <img src="images/luxury_palace_hotel.jpeg" class="card-img-top" alt="Luxury Hotel">
                <div class="card-body">
                    <h5 class="card-title" id="hotel_name1">Luxury Palace Hotel</h5>
                    <div class="mb-2">
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <span class="ms-2">5.0</span>
                    </div>
                    <p class="card-text">Experience luxury at its finest with our spacious rooms, world-class amenities, and stunning city views.</p>
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#bookingModal">Book Now</button>
                </div>
            </div>
        </div>

        <!-- Hotel Card 2 -->
        <div class="col-md-4 mb-4">
            <div class="card">
                <img src="images/seaside_resort.jpeg" class="card-img-top" alt="Seaside Resort">
                <div class="card-body">
                    <h5 class="card-title" id="hotel_name2">Seaside Resort & Spa</h5>
                    <div class="mb-2">
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="far fa-star text-warning"></i>
                        <span class="ms-2">4.0</span>
                    </div>
                    <p class="card-text">Relax by the beach in our modern rooms with private balconies and full spa access.</p>
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#bookingModal">Book Now</button>
                </div>
            </div>
        </div>

        <!-- Hotel Card 3 -->
        <div class="col-md-4 mb-4">
            <div class="card">
                <img src="images/mountain_lodge.jpeg" class="card-img-top" alt="Mountain Lodge">
                <div class="card-body">
                    <h5 class="card-title" id="hotel_name3">Mountain View Lodge</h5>
                    <div class="mb-2">
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star-half-alt text-warning"></i>
                        <span class="ms-2">4.5</span>
                    </div>
                    <p class="card-text">Escape to nature in our cozy mountain lodge featuring rustic charm and modern comfort.</p>
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#bookingModal">Book Now</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Booking Modal -->
<div class="modal fade" id="bookingModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Book Your Stay</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label for="checkIn" class="form-label">Check-in Date</label>
                        <input type="date" class="form-control" id="checkIn" required>
                    </div>
                    <div class="mb-3">
                        <label for="checkOut" class="form-label">Check-out Date</label>
                        <input type="date" class="form-control" id="checkOut" required>
                    </div>
                    <div class="mb-3">
                        <label for="guests" class="form-label">Number of Guests</label>
                        <select class="form-control" id="guests" required>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="roomType" class="form-label">Room Type</label>
                        <select class="form-control" id="roomType" required>
                            <option value="standard">Standard Room</option>
                            <option value="deluxe">Deluxe Room</option>
                            <option value="suite">Suite</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Confirm Booking</button>
            </div>
        </div>
    </div>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
<script>
    const API_URL = "http://localhost:5000/hotels";
    const SEARCH_URL = "http://localhost:5000/hotels/search";

    // Загрузка списка отелей
    function getHotels() {
        fetch(API_URL)
            .then(res => res.json())
            .then(data => {
                const hotelsContainer = document.querySelector(".hotels");
                let html = "";
                data.forEach(hotel => {
                    html += `
                        <div class="hotel-card">
                            <h3>${hotel.name}</h3>
                            <p><b>Город:</b> ${hotel.location}</p>
                            <p><b>Рейтинг:</b> ${hotel.rating}★</p>
                            <p><b>Удобства:</b> ${hotel.amenities.join(", ")}</p>
                            <button class="edit-btn" onclick="fillUpdateForm('${hotel._id}', '${hotel.name}', '${hotel.location}', '${hotel.rating}', '${hotel.amenities.join(", ")}')">Редактировать</button>
                            <button class="delete-btn" onclick="deleteHotel('${hotel._id}')">Удалить</button>
                        </div>`;
                });
                hotelsContainer.innerHTML = html;
            })
            .catch(err => {
                console.error("Ошибка при загрузке отелей:", err);
            });
    }

    // Добавление нового отеля
    function addHotel() {
        const name = document.getElementById("name").value;
        const location = document.getElementById("location").value;
        const rating = document.getElementById("rating").value;
        const amenities = document.getElementById("amenities").value.split(",");
        fetch(API_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name, location, rating, amenities })
        }).then(() => getHotels());
    }

    // Обновление отеля
    function updateHotel() {
        const id = document.getElementById("update-id").value;
        const name = document.getElementById("update-name").value;
        const location = document.getElementById("update-location").value;
        const rating = document.getElementById("update-rating").value;
        const amenities = document.getElementById("update-amenities").value.split(",");
        fetch(`${API_URL}/${id}`, {
            method: "PUT",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name, location, rating, amenities })
        }).then(() => getHotels());
    }

    // Заполнение формы редактирования
    function fillUpdateForm(id, name, location, rating, amenities) {
        document.getElementById("update-id").value = id;
        document.getElementById("update-name").value = name;
        document.getElementById("update-location").value = location;
        document.getElementById("update-rating").value = rating;
        document.getElementById("update-amenities").value = amenities;
    }

    // Удаление отеля
    function deleteHotel(id) {
        fetch(`${API_URL}/${id}`, { method: "DELETE" })
            .then(() => getHotels());
    }

    // Поиск отелей по рейтингу
    function searchHotelsByRating() {
        const minRating = parseFloat(document.getElementById("min-rating").value) || 1;
        const maxRating = parseFloat(document.getElementById("max-rating").value) || 5;
        const resultsContainer = document.getElementById("rating-results");
        fetch(`${SEARCH_URL}?minRating=${minRating}&maxRating=${maxRating}`)
            .then(res => res.json())
            .then(data => {
                let html = "";
                if (data.length > 0) {
                    data.forEach(group => {
                        group.hotels.forEach(hotel => {
                            html += `
                                <div class="hotel-card">
                                    <h3>${hotel.name}</h3>
                                    <p><b>Город:</b> ${hotel.location}</p>
                                    <p><b>Рейтинг:</b> ${hotel.rating}★</p>
                                    <p><b>Удобства:</b> ${hotel.amenities ? hotel.amenities.join(", ") : ''}</p>
                                    <button class="edit-btn" onclick="fillUpdateForm('${hotel._id}', '${hotel.name}', '${hotel.location}', '${hotel.rating}', '${hotel.amenities ? hotel.amenities.join(", ") : ''}')">Редактировать</button>
                                    <button class="delete-btn" onclick="deleteHotel('${hotel._id}')">Удалить</button>
                                </div>`;
                        });
                    });
                } else {
                    html = `<p>😔 Отелей с таким рейтингом не найдено.</p>`;
                }
                resultsContainer.innerHTML = html;
            })
            .catch(err => {
                console.error("Ошибка при поиске отелей по рейтингу:", err);
                resultsContainer.innerHTML = "<p>🚫 Ошибка при выполнении поиска.</p>";
            });
    }

    // Инициализация при загрузке страницы
    window.onload = () => {
        getHotels();
    };
</script>
</body>
</html>